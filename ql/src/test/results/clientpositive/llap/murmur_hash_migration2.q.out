PREHOOK: query: create table acid_ptn_bucket2 (a int, b int) partitioned by(ds string) clustered by (a) into 2 buckets stored as ORC TBLPROPERTIES('bucketing_version'='1')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: query: create table acid_ptn_bucket2 (a int, b int) partitioned by(ds string) clustered by (a) into 2 buckets stored as ORC TBLPROPERTIES('bucketing_version'='1')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@acid_ptn_bucket2
PREHOOK: query: alter table acid_ptn_bucket2 add partition(ds='today') location '/Users/indhm/data/acid_ptn_bucket2_os/ds=today'
PREHOOK: type: ALTERTABLE_ADDPARTS
#### A masked pattern was here ####
PREHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: query: alter table acid_ptn_bucket2 add partition(ds='today') location '/Users/indhm/data/acid_ptn_bucket2_os/ds=today'
POSTHOOK: type: ALTERTABLE_ADDPARTS
#### A masked pattern was here ####
POSTHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: Output: default@acid_ptn_bucket2@ds=today
PREHOOK: query: alter table acid_ptn_bucket2 add partition(ds='yesterday') location '/Users/indhm/data/acid_ptn_bucket2_os/ds=yesterday'
PREHOOK: type: ALTERTABLE_ADDPARTS
#### A masked pattern was here ####
PREHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: query: alter table acid_ptn_bucket2 add partition(ds='yesterday') location '/Users/indhm/data/acid_ptn_bucket2_os/ds=yesterday'
POSTHOOK: type: ALTERTABLE_ADDPARTS
#### A masked pattern was here ####
POSTHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: Output: default@acid_ptn_bucket2@ds=yesterday
PREHOOK: query: select * from acid_ptn_bucket2
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select * from acid_ptn_bucket2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
1	2	today
1	3	today
2	3	today
2	4	today
3	2	today
4	3	today
3	4	today
4	3	today
6	6	today
3	5	today
1	4	yesterday
2	2	yesterday
3	4	yesterday
3	4	yesterday
3	4	yesterday
PREHOOK: query: select * from acid_ptn_bucket2 where a=3
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select * from acid_ptn_bucket2 where a=3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
3	2	today
3	4	today
3	5	today
3	4	yesterday
3	4	yesterday
3	4	yesterday
PREHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
PREHOOK: query: select b, sum(a) from acid_ptn_bucket2 where a=3 group by b
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select b, sum(a) from acid_ptn_bucket2 where a=3 group by b
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
PREHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
3	23
PREHOOK: query: select b, sum(a) from acid_ptn_bucket2 where a=3 group by b
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select b, sum(a) from acid_ptn_bucket2 where a=3 group by b
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
5	3
2	3
4	12
PREHOOK: query: create table tj1(a int, b string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tj1
POSTHOOK: query: create table tj1(a int, b string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tj1
PREHOOK: query: insert into tj1 values(3,'ab')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@tj1
POSTHOOK: query: insert into tj1 values(3,'ab')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@tj1
POSTHOOK: Lineage: tj1.a SCRIPT []
POSTHOOK: Lineage: tj1.b SCRIPT []
Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select j1.a, j2.b from acid_ptn_bucket2 j1 join tj1 j2 on j1.a=j2.a where j1.a=3
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
PREHOOK: Input: default@tj1
#### A masked pattern was here ####
POSTHOOK: query: select j1.a, j2.b from acid_ptn_bucket2 j1 join tj1 j2 on j1.a=j2.a where j1.a=3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
POSTHOOK: Input: default@tj1
#### A masked pattern was here ####
Warning: Shuffle Join MERGEJOIN[13][tables = [$hdt$_0, $hdt$_1]] in Stage 'Reducer 2' is a cross product
PREHOOK: query: select j1.a, j2.b from acid_ptn_bucket2 j1 join tj1 j2 on j1.a=j2.a where j1.a=3
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
PREHOOK: Input: default@tj1
#### A masked pattern was here ####
POSTHOOK: query: select j1.a, j2.b from acid_ptn_bucket2 j1 join tj1 j2 on j1.a=j2.a where j1.a=3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
POSTHOOK: Input: default@tj1
#### A masked pattern was here ####
3	ab
3	ab
3	ab
3	ab
3	ab
3	ab
PREHOOK: query: insert into acid_ptn_bucket2 values(3,10,'today'),(4,3,'today')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: query: insert into acid_ptn_bucket2 values(3,10,'today'),(4,3,'today')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@acid_ptn_bucket2
POSTHOOK: Output: default@acid_ptn_bucket2@ds=today
POSTHOOK: Lineage: acid_ptn_bucket2 PARTITION(ds=today).a SCRIPT []
POSTHOOK: Lineage: acid_ptn_bucket2 PARTITION(ds=today).b SCRIPT []
PREHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
3	10
PREHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
PREHOOK: type: QUERY
PREHOOK: Input: default@acid_ptn_bucket2
PREHOOK: Input: default@acid_ptn_bucket2@ds=today
PREHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
POSTHOOK: query: select a, sum(b) from acid_ptn_bucket2 where a=3 group by a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@acid_ptn_bucket2
POSTHOOK: Input: default@acid_ptn_bucket2@ds=today
POSTHOOK: Input: default@acid_ptn_bucket2@ds=yesterday
#### A masked pattern was here ####
3	33
